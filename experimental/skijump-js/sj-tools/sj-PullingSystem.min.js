SJ.PullingSystem=class{constructor(){this.pullingArray=PAD_PULLING_POINTS,this.friction=SJ.variables.jumperFriction,this.p1=null,this.p2=null,this.index=2,this.setIndex(2)}setIndex(newIndex){this.index=newIndex,this.p1=this.pullingArray[newIndex-1],this.p2=this.pullingArray[newIndex]}update(){const jumperPos=SJ.jumper.body.position;if(jumperPos.x>=this.p2.x){if(this.index++,!(this.index<this.pullingArray.length))return this.index=1,!1;this.p1=this.p2,this.p2=this.pullingArray[this.index]}return jumperPos.x>=JUMP_POINT&&jumperPos.x<=JUMP_END_POINT&&(SJ.pad._canJump=!0,SJ.MessagesManager.canJump()),SJ.jumper.isSlowingDown||jumperPos.x>=FALL_LINE&&(SJ.jumper.isSlowingDown=!0,SJ.camera.stopFollowingJumper(),window.setTimeout(()=>{SJ.restartGame()},1e3)),!0}setNewVelocityAndAngle(){const diff_x=this.p2.x-this.p1.x,diff_y=this.p2.y-this.p1.y,alpha=atan2(diff_y,diff_x),acc=sin(alpha)*SJ.world.gravity.y,currVel=SJ.jumper.body.velocity,currVelMag=Matter.Vector.magnitude(currVel),velAlpha=atan2(currVel.y,currVel.x),diffAlpha=velAlpha-alpha;Matter.Body.setAngle(SJ.jumper.body,alpha+SJ.jumper.offsetAngle);let newVel=Matter.Vector.create(0,0);newVel.x=cos(diffAlpha)*currVelMag,newVel=Matter.Vector.rotate(newVel,alpha);let accVec=Matter.Vector.create(acc,0);accVec=Matter.Vector.rotate(accVec,alpha),newVel=Matter.Vector.add(newVel,accVec),newVel=Matter.Vector.mult(newVel,1-this.friction-SJ.variables.padFriction),SJ.jumper.body.velocity=newVel}};